(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-50455f76"],{"37ce":function(t,e,a){"use strict";var s=a("9761"),r=a.n(s);r.a},9761:function(t,e,a){},e90b:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"wrapper container"},[a("loading",{attrs:{active:t.isLoading},on:{"update:active":function(e){t.isLoading=e}}}),t.carts.length>0?a("div",{staticClass:"row justify-content-center flex-md-row flex-column-reverse pb-3 mt-3"},[a("div",{staticClass:"col-md-7"},[a("div",{staticClass:"bg-white"},[a("router-link",{staticClass:"h5 text-dark back",attrs:{to:"/shopcart"}},[a("i",{staticClass:"fas fa-chevron-left mr-2"}),a("span",{staticClass:"continue"},[t._v("返回購物車清單")])]),t._m(0),a("validation-observer",{scopedSlots:t._u([{key:"default",fn:function(e){var s=e.invalid;return[a("div",{staticClass:"col-md-12"},[a("form",{on:{submit:function(e){return e.preventDefault(),t.submitOrder(e)}}},[a("div",{staticClass:"form-group"},[a("validation-provider",{attrs:{rules:"required|email"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.errors,r=e.classes,o=e.passed;return[a("label",{attrs:{for:"ContactMail"}},[a("span",{staticClass:"text-danger"},[t._v("*")]),t._v(" Email")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.temporders.email,expression:"temporders.email"}],staticClass:"form-control rounded-0",class:r,attrs:{type:"email",name:"Email",id:"ContactMail","aria-describedby":"emailHelp",placeholder:"輸入Email"},domProps:{value:t.temporders.email},on:{input:function(e){e.target.composing||t.$set(t.temporders,"email",e.target.value)}}}),a("span",{staticClass:"invalid-feedback"},[t._v(t._s(s[0]))]),o?a("span",{staticClass:"valid-feedback"},[t._v("Email 正確")]):t._e()]}}],null,!0)})],1),a("div",{staticClass:"form-group"},[a("validation-provider",{attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.errors,r=e.classes,o=e.passed;return[a("label",{attrs:{for:"ContactName"}},[a("span",{staticClass:"text-danger"},[t._v("*")]),t._v(" 姓名")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.temporders.name,expression:"temporders.name"}],staticClass:"form-control rounded-0",class:r,attrs:{type:"text",name:"姓名",id:"ContactName",placeholder:"輸入姓名"},domProps:{value:t.temporders.name},on:{input:function(e){e.target.composing||t.$set(t.temporders,"name",e.target.value)}}}),a("span",{staticClass:"invalid-feedback"},[t._v(t._s(s[0]))]),o?a("span",{staticClass:"valid-feedback"},[t._v("姓名正確")]):t._e()]}}],null,!0)})],1),a("div",{staticClass:"form-group"},[a("validation-provider",{attrs:{rules:"required|min:8"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.errors,r=e.classes,o=e.passed;return[a("label",{attrs:{for:"ContactPhone"}},[a("span",{staticClass:"text-danger"},[t._v("*")]),t._v(" 電話")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.temporders.tel,expression:"temporders.tel"}],staticClass:"form-control rounded-0",class:r,attrs:{type:"text",name:"電話",id:"ContactPhone",placeholder:"輸入電話"},domProps:{value:t.temporders.tel},on:{input:function(e){e.target.composing||t.$set(t.temporders,"tel",e.target.value)}}}),a("span",{staticClass:"invalid-feedback"},[t._v(t._s(s[0]))]),o?a("span",{staticClass:"valid-feedback"},[t._v("電話號碼正確")]):t._e()]}}],null,!0)})],1),a("div",{staticClass:"form-group"},[a("validation-provider",{attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.errors,r=e.classes,o=e.passed;return[a("label",{attrs:{for:"Address"}},[a("span",{staticClass:"text-danger"},[t._v("*")]),t._v(" 運送地址")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.temporders.address,expression:"temporders.address"}],staticClass:"form-control",class:r,attrs:{name:"地址",type:"text",id:"Address",placeholder:"輸入地址"},domProps:{value:t.temporders.address},on:{input:function(e){e.target.composing||t.$set(t.temporders,"address",e.target.value)}}}),a("span",{staticClass:"invalid-feedback"},[t._v(t._s(s[0]))]),o?a("span",{staticClass:"valid-feedback"},[t._v("地址正確")]):t._e()]}}],null,!0)})],1),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"Pay"}},[a("span",{staticClass:"text-danger"},[t._v("*")]),t._v(" 付款方式")]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.temporders.payment,expression:"temporders.payment"}],staticClass:"form-control",attrs:{id:"Pay",name:"付款方式",required:""},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.temporders,"payment",e.target.multiple?a:a[0])}}},[a("option",{attrs:{value:"",selected:"",disabled:""}},[t._v("請選擇付款方式")]),t._l(t.payMoneyway,(function(e,s){return a("option",{key:s+1,domProps:{value:e}},[t._v(t._s(e))])}))],2)]),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"Message"}},[t._v("留言")]),a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.temporders.message,expression:"temporders.message"}],staticClass:"form-control",attrs:{id:"Message",rows:"7"},domProps:{value:t.temporders.message},on:{input:function(e){e.target.composing||t.$set(t.temporders,"message",e.target.value)}}})]),a("div",{staticClass:" w-100 d-flex flex-column-reverse flex-md-row mt-4 justify-content-between align-items-md-center align-items-end"},[a("button",{staticClass:"btn btn-primary btn-block py-3 px-7 rounded-0",attrs:{type:"submit",disabled:s}},[t.btnsubmitstatus?a("i",{staticClass:"fas fa-spinner fa-spin"}):t._e(),t._v("送出訂單")])])])])]}}],null,!1,2453336863)})],1)]),a("div",{staticClass:"col-md-5 mb-3 mb-md-0 mb-lg-0"},[a("div",{staticClass:"border p-4 mb-4"},[t._m(1),t._l(t.carts,(function(e){return a("div",{key:e.product.id+1,staticClass:"d-flex mb-3 "},[a("img",{staticClass:"product-img mr-2",attrs:{src:e.product.imageUrl[0],alt:"product-img"}}),a("div",{staticClass:"w-100"},[a("div",{staticClass:"d-flex justify-content-between font-weight-bold"},[a("p",{staticClass:"product-text mb-0"},[t._v(t._s(e.product.title))]),a("p",{staticClass:"product-quantity mb-0"},[t._v("X"+t._s(e.quantity))])]),a("div",{staticClass:"d-flex justify-content-between"},[a("p",{staticClass:"text-muted mb-0"},[a("small",{staticClass:"product-small-text"},[t._v(t._s(t._f("money")(e.product.price))+" / "+t._s(e.product.unit))])]),a("p",{staticClass:"product-price mb-0"},[t._v(t._s(t._f("money")(e.product.price)))])])]),a("hr")])})),a("table",{staticClass:"pay-info table mt-4 border-top border-bottom text-muted"},[a("tbody",[a("tr",[a("th",{staticClass:"border-0 px-0 pt-4 font-weight-normal",attrs:{scope:"row"}},[t._v("小計")]),a("td",{staticClass:"text-right border-0 px-0 pt-4"},[t._v(t._s(t._f("money")(t.cartTotal)))])]),a("tr",[a("th",{staticClass:"border-0 px-0 pt-0 pb-4 font-weight-normal",attrs:{scope:"row"}},[t._v("付款方式")]),a("td",{staticClass:"text-right border-0 px-0 pt-0 pb-4"},[t._v(t._s(t.temporders.payment))])]),a("tr",[a("td",{staticClass:"text-right border-0 px-0 pt-0 pb-4",attrs:{colspan:"2"}},[a("div",{staticClass:"input-group mt-3 input-group-sm"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.coupon_code,expression:"coupon_code"}],staticClass:"form-control",attrs:{type:"text",placeholder:"請輸入優惠碼"},domProps:{value:t.coupon_code},on:{input:function(e){e.target.composing||(t.coupon_code=e.target.value)}}}),a("div",{staticClass:"input-group-append"},[a("button",{staticClass:"btn btn-outline-primary",attrs:{type:"button",disabled:t.loadingItem},on:{click:function(e){return e.preventDefault(),t.addCouponCode(e)}}},[t.loadingItem?a("i",{staticClass:"fas fa-spinner fa-spin"}):t._e(),t._v("套用優惠碼 ")])])])])])])]),a("div",{staticClass:"d-flex justify-content-between mt-4"},[a("p",{staticClass:"mb-0 h4 font-weight-bold"},[t._v("總計")]),t.coupon.enabled?a("p",{staticClass:"mb-0 h4 font-weight-bold text-danger"},[t._v(" "+t._s(t._f("money")(t.cartTotal*(t.coupon.percent/100))))]):a("p",{staticClass:"mb-0 h4 font-weight-bold text-danger"},[t._v(t._s(t._f("money")(t.cartTotal)))])])],2)])]):t._e()],1)},r=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("h2",{staticClass:"font-weight-bold mb-3"},[a("i",{staticClass:"fas fa-leaf mr-2 text-primary"}),t._v("顧客資訊")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("h3",{staticClass:"font-weight-bold mb-3"},[a("i",{staticClass:"fas fa-leaf mr-2 text-primary"}),t._v("訂單明細")])}],o=a("3508"),i={data(){return{products:[],tmpProducts:{imageUrl:[]},isLoading:!1,loadingItem:!1,btnsubmitstatus:!1,carts:[],cartTotal:0,coupon_code:"",coupon:{},temporders:{name:"",email:"",tel:"",address:"",payment:"",message:""},payMoneyway:["WebATM","ATM","Barcode","Credit","ApplePay","GooglePay"]}},created(){this.getCart()},methods:{getCart(){const t=this;t.isLoading=!0;const e="https://course-ec-api.hexschool.io/api/d52eae5f-b113-4dd1-81cc-46bd383ac57a/ec/shopping";t.$http.get(e).then(e=>{t.carts=e.data.data,t.updateTotall(),t.isLoading=!1}).catch(()=>{o["a"].fire({title:"無法取得資料，稍後再試",icon:"error"}),t.isLoading=!1})},updateTotall(){const t=this;let e=0;t.carts.forEach(a=>{e+=a.product.price*a.quantity,t.cartTotal=e})},addCouponCode(){const t=this,e="https://course-ec-api.hexschool.io/api/d52eae5f-b113-4dd1-81cc-46bd383ac57a/ec/coupon/search";t.isLoading=!0,t.loadingItem=!0,t.$http.post(e,{code:t.coupon_code}).then(e=>{t.getCart(),t.coupon=e.data.data;const a=(new Date).getTime(),s=1e3*e.data.data.deadline.timestamp;a>s?o["a"].fire({text:"優惠券已過期",icon:"error"}):o["a"].fire({title:"優惠卷已套用",icon:"success"}),t.isLoading=!1,t.loadingItem=!1}).catch(e=>{const a=e.response.data.errors;if(a)a.code.forEach(t=>{o["a"].fire({title:""+t,icon:"error"})});else{const{message:t}=e.response.data;o["a"].fire({title:""+t,icon:"error"})}t.isLoading=!1,t.loadingItem=!1})},submitOrder(){const t=this;t.btnsubmitstatus=!0;const e="https://course-ec-api.hexschool.io/api/d52eae5f-b113-4dd1-81cc-46bd383ac57a/ec/orders",a={...t.temporders};t.coupon.enabled&&(a.coupon=t.coupon.code),t.$http.post(e,a).then(e=>{t.$bus.$emit("update-total"),o["a"].fire({text:"訂單已送出",icon:"success"}),t.getCart(),t.loadingItem=!1,t.btnsubmitstatus=!1,t.$router.push("/checkout/"+e.data.data.id)}).catch(()=>{o["a"].fire({text:"訂單已送出失敗，稍後在試",icon:"error"}),t.loadingItem=!1,t.btnsubmitstatus=!1})}}},n=i,l=(a("37ce"),a("2877")),c=Object(l["a"])(n,s,r,!1,null,null,null);e["default"]=c.exports}}]);
//# sourceMappingURL=chunk-50455f76.a6351f7d.js.map